<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FinSight Analyzer</title>
    <style>
        body { font-family: -apple-system,
BlinkMacSystemFont, sans-serif; margin: 40px auto; max-width:
1200px; background-color: #1e1e1e; color: #e0e0e0; }
        textarea { width: 100%; box-sizing: border-box;
border: 1px solid #444; border-radius: 5px; padding: 10px;
font-size: 1rem; background-color: #2d2d2d; color: #e0e0e0; }
        textarea::placeholder { color: #888; }
        button { background-color: #007bff; color: white;
padding: 10px 15px; border: none; border-radius: 5px; cursor:
pointer; font-size: 1rem; }
        #analysis-container { display: flex; flex-direction:
row; gap: 20px; margin-top: 20px; }
        #entity-vis { flex-grow: 1; border: 1px solid #444;
padding: 20px; border-radius: 5px; max-height: 600px;
overflow-y: auto; }
        #legend { flex-shrink: 0; width: 300px; }
        .entities { line-height: 2.5; }
        .entity { color: #1e1e1e; font-weight: bold; }
        table { width: 100%; margin-top: 20px;
border-collapse: collapse; }
        th, td { border: 1px solid #444; padding: 8px;
text-align: left; font-size: 0.9rem; }
        th { background-color: #3a3a3a; }
        #sentiment { font-size: 1.2rem; font-weight: bold;
margin-bottom: 15px; }
    </style>
</head>
<body>
    <h1>FinSight ðŸ“ˆ</h1>
    <p>This application uses a custom-trained NLP model to
identify entities and a rule-based model for sentiment in
financial text.</p>

    <form id="nlp-form">
        <textarea id="text-input" rows="10" placeholder=
"Paste an article here..."></textarea>
        <br><br>
        <button type="submit">Analyze Text</button>
    </form>

    <div id="analysis-container">
        <div id="entity-vis">
            <!-- Visualization appears here -->
        </div>
        <div id="legend">
             <!-- Legend appears here -->
        </div>
    </div>
    <!-- This div is for the sentiment, which now appears 
above the main results -->
    <div id="sentiment"></div>

    <script>

document.getElementById('nlp-form').addEventListener('submit'
, async function(event) {
            event.preventDefault();
            const text =
document.getElementById('text-input').value;
            const entityVisDiv =
document.getElementById('entity-vis');
            const legendDiv =
document.getElementById('legend');
            const sentimentDiv =
document.getElementById('sentiment');

            entityVisDiv.innerHTML = 'Analyzing...';
            legendDiv.innerHTML = '';
            sentimentDiv.innerHTML = '';

            const response = await fetch('/analyze', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json'
},
                body: JSON.stringify({ text: text }),
            });

            const data = await response.json();

            entityVisDiv.innerHTML = data.html;

            sentimentDiv.innerHTML = `<h3>Sentiment Analysis
</h3><p>Overall Sentiment: <strong>${data.sentiment_label}</
strong> (Score: ${data.sentiment_score.toFixed(3)})</p>`;

            if (data.legend &&
Object.keys(data.legend).length > 0) {
                let legendHtml = '<h3>Entity Legend</h3><table><tr><th>Label</th><th>Description</th></tr>';
                for (const label in data.legend) {
                    const color = data.legend[label].color;
                    const description =
data.legend[label].description;
                    const coloredLabel = `<span style=
"background-color:${color}; color: #1e1e1e; padding: 0.2em 
0.4em; border-radius: 0.35em; font-weight: bold;">${label}</
span>`;
                    legendHtml += `<tr><td>${coloredLabel}</
td><td>${description}</td></tr>`;
                }
                legendHtml += '</table>';
                legendDiv.innerHTML = legendHtml;
            }
        });
    </script>

</body>
</html>